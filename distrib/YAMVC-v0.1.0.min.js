/*! YAMVC v0.1.0 - 2013-12-02 
 *  License:  */
(function(t){"use strict";t.Base=t.Base||function(){function t(){this.set("listeners",{}),this.set("suspendEvents",!1),this.bindMethods.apply(this,arguments),this.init.apply(this,arguments)}return t.prototype.init=function(){},t.prototype.initConfig=function(){},t.prototype.bindMethods=function(t){for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(this[e]=t[e].bind(this))},t.prototype.set=function(t,e){var n="_"+t,i=this[n];return e!==i&&(this[n]=e,this.fireEvent(t+"Change",this,e,i)),this},t.prototype.get=function(t){return this["_"+t]},t.prototype.fireEvent=function(t){if(!this._suspendEvents)return!0;var e=!0,n=Array.prototype.shift;n.call(arguments);for(var i=0,r=this._listeners[t]||[],o=r.length;o>i;i++)e&&(e=r[i].call(n.apply(arguments),arguments));return e},t.prototype.addListener=function(t,e){var n=this._listeners[t]||[];return n.push(e),this._listeners[t]=n,this},t.prototype.onChange=function(t,e){return this.addListener(t+"Change",e),this},t.prototype.unbindOnChange=function(t,e){for(var n=this._listeners[t+"Change"]||[],i=0,r=n.length;r>i;i++)n[i]===e&&n.splice(i,1);return this._listeners[t+"Change"]=n,this},t.prototype.suspendEvents=function(t){return t=t||!0,this.set("suspendEvents",t),this},t.extend=function(e){var n=this,i=function(){e.prototype.constructor.apply(this,arguments)};for(var r in n.prototype)n.prototype.hasOwnProperty(r)&&(i.prototype[r]=n.prototype[r]);return i.extend=t.extend,i},t}()})(window),function(t){var e;t.Controller=Base.extend(function n(){Base.prototype.constructor.apply(this,arguments)}),n.prototype.init=function(t){var n;return t=t||{},n=t.config||{},e=e||new Router,this.set("initOpts",t),this.set("config",n),this.set("routes",n.routes||{}),this.initConfig(),this},n.prototype.initConfig=function(){var t=this.get("routes");if(t)for(var n in t)if(t.hasOwnProperty(n)){var i=this[t[n]].bind(this);e.when(n,i)}return this},n.prototype.getRouter=function(){return e},n.prototype.redirectTo=function(e){return t.location.hash=e,this}}(window),function(t){t.Router=Base.extend(function e(){Base.prototype.constructor.apply(this)}),e.prototype.init=function(){this.set("routing",{}),this.bindEvents()},e.prototype.bindEvents=function(){return t.onhashchange=this.onHashChange.bind(this),this},e.prototype.onHashChange=function(){var e=this.get("routing"),n=t.location.hash.substr(1),i=n.split("/"),r=i.shift();if(e[r]){var o=[];if(e[r].params)for(var s=0,p=e[r].params.length;p>s;s++){var h=e[r].params[s],a=i[s],u=RegExp(h.substr(1,h.length-2));o.push(a.match(u).input)}e[r].callback.apply(null,o)}return this},e.prototype.restore=function(){return this.onHashChange(),this},e.prototype.when=function(t,e){var n=this.get("routing"),i=t.split("/"),r=i.shift();return n[r]={callback:e,params:i},this.set("routing",n),this}}(window),function(t){var e;t.ViewManager={views:{},i:0,add:function(t,e){this.views[t]=e,this.i++},get:function(t){return this.views[t]}},e={tpl:{},add:function(t,e){this.tpl[t]=e},get:function(t){return this.tpl[t]}},t.View=Base.extend(function n(){Base.prototype.constructor.apply(this,arguments)}),n.prototype.init=function(t){var e,n;t=t||{},e=t.config||{},e.id=n=e.id||"view-"+ViewManager.i,e.views=e.views||{},this.set("initOpts",t),this.set("config",e),this.initConfig(),ViewManager.add(n,this)},n.prototype.initConfig=function(){var t,n,i=this,r=i.get("config"),o=document.createElement("div");if(!r.tpl)throw Error("no tpl set");if(!e.get(r.tpl)){if(t=document.getElementById(r.tpl),!t)throw Error("no tpl "+r.tpl+" found");e.add(r.tpl,t.parentNode.removeChild(t))}n=e.get(r.tpl).childNodes.item(1).cloneNode(!0),o.appendChild(n),i.set("tpl",o)},n.prototype.render=function(t){var e,n,i=this,r=i.get("tpl"),o=i.get("config"),s=o.renderTo,p=t||o.models,h=o.parent,a=o.parent;if(h?h=s?h.querySelectorAll(s).item(0):h.get("el"):s&&(h=document.querySelectorAll(s).item(0)),p){n=r.innerHTML;var u=n.match(/\{\{(.*?)\}\}/gi);if(u)for(var c=0,f=u.length;f>c;c++){var l=u[c],d=l.substr(2,l.length-4);n=p[d]?n.replace(l,p[d]):n.replace(l,"")}r.innerHTML=n}return e=r.childNodes.item(0),e.setAttribute("yamvc-id",o.id),i.set("el",e),h&&(h.appendChild(e),a&&(a.views=a.views||{},a.views[o.id]=i),i.set("isInDOM",!0),i.reAppendChildren()),r.childNodes.item(0)},n.prototype.removeChildren=function(){for(var t=this.get("config").views||[],e=0,n=t.length;n>e;e++)t[e].clear()},n.prototype.clear=function(){var t=this,e=t.get("el");t.isInDOM()&&(e.parentNode.removeChild(e),t.set("isInDOM",!1))},n.prototype.isInDOM=function(){return this._isInDOM},n.prototype.appendTo=function(t,e){var n=this,i=n.get("config"),r=i.id,o=t.get("config").views,s=e?t.get("el").querySelector(e):t.get("el");e&&(i.renderTo=e),i.parent&&i.parent.get("config").id!==t.get("config").id&&delete i.parent.get("config").views[r],!n.isInDOM()&&t.isInDOM()&&(n.get("el")?(s.appendChild(n.get("el")),n.set("isInDOM",!0),n.reAppendChildren()):n.render()),o[r]=n,i.parent=t},n.prototype.reAppendChildren=function(){var t=this.get("config").views;for(var e in t)t.hasOwnProperty(e)&&t[e].appendTo(this)}}(window);
//@ sourceMappingURL=YAMVC-v0.1.0.min.js.map