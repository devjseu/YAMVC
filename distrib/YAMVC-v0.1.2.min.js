/*! YAMVC v0.1.2 - 2013-12-15 
 *  License:  */
(function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig()},e.prototype.initConfig=function(){if(n.Core.prototype.initConfig.apply(this),!config.model)throw Error("Set model type for collection")},t.yamvc=n,t.yamvc.Collection=e})(window),function(t){"use strict";var e,n,i=t.yamvc||{};e=i.Core.extend(function(){i.Core.apply(this,arguments)}),e.prototype.init=function(t){var e,o=this;return t=t||{},e=t.config||{},n=n||new i.Router,o.set("initOpts",t),o.set("config",e),o.set("routes",e.routes||{}),o.set("events",e.events||{}),o.set("views",e.views||{}),o.initConfig(),o.renderViews(),o},e.prototype.initConfig=function(){i.Core.prototype.initConfig.apply(this);var t=this,e=t.get("routes"),o=t.get("events"),r=t.get("views");if(e)for(var s in e)if(e.hasOwnProperty(s)){var a=t[e[s]].bind(t);n.when(s,a)}if(o&&r)for(var p in r)r.hasOwnProperty(p)&&r[p].addListener("render",t.resolveEvents.bind(t));return this},e.prototype.renderViews=function(){var t=this,e=t.get("views");for(var n in e)e.hasOwnProperty(n)&&e[n].getAutoCreate&&e[n].getAutoCreate()&&e[n].render()},e.prototype.resolveEvents=function(t){var e,n=this.get("events");for(var i in n)if(n.hasOwnProperty(i)){e=n[i];for(var o=t.get("el").querySelectorAll(i),r=0,s=o.length;s>r;r++)for(var a in e)e.hasOwnProperty(a)&&o[r].addEventListener(a,e[a].bind(this,t))}},e.prototype.getRouter=function(){return n},e.prototype.redirectTo=function(e){return t.location.hash=e,this},t.yamvc.Controller=e}(window),function(t){"use strict";function e(){for(var t=0,e=r.length;e>t;t++)r[t]()}var n,i,o=t.yamvc||{},r=[];n=o.Core||function(){function t(){this.set("listeners",{}),this.set("suspendEvents",!1),this.bindMethods.apply(this,arguments),this.init.apply(this,arguments)}return t.prototype.init=function(){},t.prototype.initConfig=function(){var t,e,n,i=this,o=i.get("config"),r=function(n){t="get"+n.charAt(0).toUpperCase()+n.slice(1),e="set"+n.charAt(0).toUpperCase()+n.slice(1),i[t]=function(){return i.get("config")[n]},i[e]=function(t,e){var n=i.get("config")[t];e!==n&&(i.get("config")[t]=e,i.fireEvent(t+"Change",this,e,n))}};for(n in o)o.hasOwnProperty(n)&&r(n)},t.prototype.bindMethods=function(t){for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(this[e]=t[e].bind(this))},t.prototype.set=function(t,e){var n="_"+t,i=this[n];return e!==i&&(this[n]=e,this.fireEvent(t+"Change",this,e,i)),this},t.prototype.get=function(t){return this["_"+t]},t.prototype.init=function(){},t.prototype.fireEvent=function(t){if(this._listeners||(this._listeners=[]),this._suspendEvents)return!0;var e=!0,n=Array.prototype.shift;n.call(arguments);for(var i=0,o=this._listeners[t]||[],r=o.length;r>i;i++)if(e){var s=n.call(arguments);e=o[i].apply(s,arguments)}return e},t.prototype.addListener=function(t,e){this._listeners||(this._listeners=[]);var n=this._listeners[t]||[];return n.push(e),this._listeners[t]=n,this},t.prototype.removeListener=function(t,e){var n,i=this._listeners;if(i)if(e){if("function"==typeof e)for(var o=0,r=i.length;r>o;o++)i[o]===e&&(n=o);else n=e;i.splice(n,1)}else this._listeners=[];return this},t.prototype.suspendEvents=function(t){return t=t||!0,this.set("suspendEvents",t),this},t.prototype.onChange=function(t,e){return this.addListener(t+"Change",e),this},t.prototype.unbindOnChange=function(t,e){for(var n=this._listeners[t+"Change"]||[],i=0,o=n.length;o>i;i++)n[i]===e&&n.splice(i,1);return this._listeners[t+"Change"]=n,this},t.onReady=function(t){r.push(t),i||"complete"===document.readyState||(i=setInterval(function(){"complete"===document.readyState&&(clearInterval(i),e())},10))},t.mixin=function(t,e){var n,i;e?n="function"==typeof t?t.prototype:t:(e="function"==typeof t?t.prototype:t,n=this.prototype);for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i])},t.extend=function(e){var n=this,i=function(){e.prototype.constructor.apply(this,arguments)};for(var o in n.prototype)n.prototype.hasOwnProperty(o)&&(i.prototype[o]=n.prototype[o]);return i.extend=t.extend,i.mixin=t.mixin,i},t}(),o.Core=n,t.yamvc=o}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig()},e.prototype.initConfig=function(){var t=this;n.Core.prototype.initConfig.apply(this),t.set("lastResponse",{})},e.prototype.read=function(){},e.prototype.create=function(){},e.prototype.update=function(){},e.prototype.destroy=function(){},e.prototype.update=function(){},e.prototype.getResult=function(){var t=this;return t.get("lastResponse")},t.yamvc=n,t.yamvc.data=t.yamvc.data||{},t.yamvc.data.Proxy=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig()},e.prototype.initConfig=function(){n.Core.prototype.initConfig.apply(this)},e.prototype.read=function(){var t,e=localStorage[model.getNamespace()]||{};for(t in e)e.hasOwnProperty(t)&&(model[t]=e[t])},e.prototype.create=function(){var t,e;localStorage[e.getNamespace()]={};for(t in e)e.hasOwnProperty(t)&&"function"!=typeof e[t]&&(localStorage[e.getNamespace()][t]=e[t])},e.prototype.update=function(){},e.prototype.destroy=function(){delete localStorage[model.getNamespace()]},e.prototype.update=function(){},t.yamvc=n,t.yamvc.data=t.yamvc.data||{},t.yamvc.data.proxy=t.yamvc.data.proxy||{},t.yamvc.data.proxy.Localstorage=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig(),i.initData()},e.prototype.initConfig=function(){var t=this,e=t.get("config");if(n.Core.prototype.initConfig.apply(this),!e.namespace)throw Error("Model need to have namespace property in your model configuration");return this},e.prototype.initData=function(){var t=this,e=t.get("initOpts"),n=t.get("config");t.set("data",e.data||{}),t.set("idProperty",n.idProperty||"_id")},e.prototype.$set=function(t,e){var n=this,i=n.get("data"),o=i[t];e!==o&&(i[t]=e,n.set("isDirty",!0),n.fireEvent("property"+t.charAt(0).toUpperCase()+t.slice(1)+"Change",n,e,o))},e.prototype.$get=function(t){var e=this;return e.get("data")[t]},e.prototype.setData=function(t){var e,n=this,i=n.get("data");for(e in t)t.hasOwnProperty(e)&&n.$set(e,t[e]);n.fireEvent("dataChange",n,i)},e.prototype.load=function(t){var e,n,i=this,o=i.get("data"),r=i.get("idProperty"),s=0;for(n in t)s++;if(0===s||o[r]===undefined)throw Error("You need to pass at least one property value to load model");0===s&&(t[r]=o[r]),e=function(){"success"===i.getProxy().getStatus()?(i.set("isDirty",!1),i.set("data",i.getProxy().getResult()),i.fireEvent("loaded",i,i.getProxy().getResult())):i.fireEvent("error",i,"read")},i.getProxy().read(i.getNamespace(),t,e)},e.prototype.save=function(){var t,e,n=this,i=n.get("data"),o=n.get("idProperty");t=function(){"success"===n.getProxy().getStatus()?(n.set("isDirty",!1),n.set("data",n.getProxy().getResult()),n.fireEvent("saved",n,n.getProxy().getResult())):n.fireEvent("error",n,e)},i[o]===undefined?(e="create",n.getProxy().create(n.getNamespace(),i,t)):(e="update",n.getProxy().update(n.getNamespace(),i,t))},e.prototype.destroy=function(){var t,e=this,n=e.get("data"),i=e.get("idProperty"),o={};o[i]=n[i],t=function(){"success"===e.getProxy().getStatus()?(e.set("isDirty",!1),e.set("data",e.getProxy().getResult()),e.fireEvent("loaded",e,e.getProxy().getResult())):e.fireEvent("error",e,"read")},e.getProxy().read(e.getNamespace(),o,t)},t.yamvc=n,t.yamvc.Model=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this)}),e.prototype.init=function(){this.set("routing",{}),this.bindEvents()},e.prototype.bindEvents=function(){return t.onhashchange=this.onHashChange.bind(this),this},e.prototype.onHashChange=function(){var e=this.get("routing"),n=t.location.hash.substr(1),i=n.split("/"),o=i.shift();if(e[o]){var r=[];if(e[o].params)for(var s=0,a=e[o].params.length;a>s;s++){var p=e[o].params[s],c=i[s],u=RegExp(p.substr(1,p.length-2));r.push(c.match(u).input)}e[o].callback.apply(null,r)}return this},e.prototype.restore=function(){return this.onHashChange(),this},e.prototype.when=function(t,e){var n=this.get("routing"),i=t.split("/"),o=i.shift();return n[o]={callback:e,params:i},this.set("routing",n),this},t.yamvc.Router=e}(window),function(t){"use strict";var e,n,i,o=t.yamvc||{};e={views:{},i:0,add:function(t,e){this.views[t]=e,this.i++},get:function(t){return this.views[t]}},n={tpl:{},add:function(t,e){this.tpl[t]=e},get:function(t){return this.tpl[t]}},i=o.Core.extend(function(){o.Core.apply(this,arguments)}),i.prototype.init=function(t){o.Core.prototype.init.apply(this);var n,i,r=this;t=t||{},n=t.config||{},n.id=i=n.id||"view-"+e.i,n.views=n.views||{},r.set("initOpts",t),r.set("config",n),r.initConfig(),e.add(i,r)},i.prototype.initConfig=function(){o.Core.prototype.initConfig.apply(this),this.initTemplate(),this.initModels()},i.prototype.initTemplate=function(){var t,e=this,i=e.get("config"),o=document.createElement("div");if(!i.tpl)throw Error("no tpl set");if(!n.get(i.tpl)){if(t=document.getElementById(i.tpl),!t)throw Error("no tpl "+i.tpl+" found");n.add(i.tpl,t.parentNode.removeChild(t))}o.innerHTML=n.get(i.tpl).innerHTML,e.set("tpl",o)},i.prototype.initModels=function(){var t,e,n=this;t=n.getModels();for(e in t)t.hasOwnProperty(e)&&n.setModel(e,t[e])},i.prototype.setModel=function(t,e){var n=this,i=n.getModels();i[e.getNamespace()]=e,n.setModels(i)},i.prototype.getModel=function(t){var e=this,n=e.getModels();return n[t]},i.prototype.render=function(t){var e,n,i,o=this,r=o.get("tpl"),s=document.createElement("div"),a=o.get("config"),p=a.renderTo,c=t||a.models,u=a.parent,f=a.parent;if(u?u=p?u.querySelectorAll(p).item(0):u.get("el"):p&&(u=document.querySelectorAll(p).item(0)),c){if(i=r.innerHTML,n=i.match(/\{\{(.*?)\}\}/gi))for(var y=0,l=n.length;l>y;y++){var h=n[y],g=h.substr(2,h.length-4).split(".");i=c[g[0]]!==undefined&&"function"!=typeof c[g[0]]?i.replace(h,c[g[0]].$get(g[1])):i.replace(h,"")}s.innerHTML=i}for(var d=0;r.childNodes.length>d&&1!==r.childNodes.item(d).nodeType;)d++;return e=s.childNodes.item(d),e.setAttribute("yamvc-id",a.id),o.set("el",e),u&&(u.appendChild(e),f&&(f.views=f.views||{},f.views[a.id]=o),o.set("isInDOM",!0),o.reAppendChildren(),o.fireEvent("render",null,o)),e},i.prototype.partialRender=function(t){var e,n=this,i=n.get("tpl"),o=i.querySelector(t),r=n.queryEl(t),s=o.innerHTML,a=n.getModels();if(e=s.match(/\{\{(.*?)\}\}/gi))for(var p=0,c=e.length;c>p;p++){var u=e[p],f=u.substr(2,u.length-4).split(".");s=a[f[0]]!==undefined&&"function"!=typeof a[f[0]]?s.replace(u,a[f[0]].$get(f[1])):s.replace(u,"")}r.innerHTML=s,n.fireEvent("partialRender",null,n,r)},i.prototype.queryEl=function(t){return this.get("el").querySelector(t)},i.prototype.addChild=function(t,e){t.appendTo(this,e),this.fireEvent("elementAdded",this,t)},i.prototype.removeChildren=function(){for(var t=this.get("config").views||[],e=0,n=t.length;n>e;e++)t[e].clear()},i.prototype.clear=function(){var t=this,e=t.get("el");t.isInDOM()&&(e.parentNode.removeChild(e),t.set("isInDOM",!1))},i.prototype.isInDOM=function(){return this._isInDOM},i.prototype.appendTo=function(t,e){var n=this,i=n.get("config"),o=i.id,r=t.get("config").views,s=e?t.get("el").querySelector(e):t.get("el");e&&(i.renderTo=e),i.parent&&i.parent.get("config").id!==t.get("config").id&&delete i.parent.get("config").views[o],!n.isInDOM()&&t.isInDOM()&&(n.get("el")?(s.appendChild(n.get("el")),n.set("isInDOM",!0),n.reAppendChildren(),n.fireEvent("render",null,n)):n.render()),r[o]=n,i.parent=t},i.prototype.reAppendChildren=function(){var t=this.get("config").views;for(var e in t)t.hasOwnProperty(e)&&t[e].appendTo(this)},o.ViewManager=e,t.yamvc=o,t.yamvc.View=i}(window);
//@ sourceMappingURL=YAMVC-v0.1.2.min.js.map