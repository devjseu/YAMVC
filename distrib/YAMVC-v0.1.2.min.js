/*! YAMVC v0.1.2 - 2013-12-16 
 *  License:  */
(function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,r=this;t=t||{},e=t.config||{},r.set("initOpts",t),r.set("config",e),r.initConfig()},e.prototype.initConfig=function(){if(n.Core.prototype.initConfig.apply(this),!config.model)throw Error("Set model type for collection");if(!config.model instanceof n.Model)throw Error("Set proper model type for collection")},t.yamvc=n,t.yamvc.Collection=e})(window),function(t){"use strict";var e,n,r=t.yamvc||{};e=r.Core.extend(function(){r.Core.apply(this,arguments)}),e.prototype.init=function(t){var e,i=this;return t=t||{},e=t.config||{},n=n||new r.Router,i.set("initOpts",t),i.set("config",e),i.set("routes",e.routes||{}),i.set("events",e.events||{}),i.set("views",e.views||{}),i.initConfig(),i.renderViews(),i},e.prototype.initConfig=function(){r.Core.prototype.initConfig.apply(this);var t=this,e=t.get("routes"),i=t.get("events"),o=t.get("views");if(e)for(var s in e)if(e.hasOwnProperty(s)){var a=t[e[s]].bind(t);n.when(s,a)}if(i&&o)for(var p in o)o.hasOwnProperty(p)&&o[p].addListener("render",t.resolveEvents.bind(t));return this},e.prototype.renderViews=function(){var t=this,e=t.get("views");for(var n in e)e.hasOwnProperty(n)&&e[n].getAutoCreate&&e[n].getAutoCreate()&&e[n].render()},e.prototype.resolveEvents=function(t){var e,n=this.get("events");for(var r in n)if(n.hasOwnProperty(r)){e=n[r];for(var i=t.get("el").querySelectorAll(r),o=0,s=i.length;s>o;o++)for(var a in e)e.hasOwnProperty(a)&&i[o].addEventListener(a,e[a].bind(this,t))}},e.prototype.getRouter=function(){return n},e.prototype.redirectTo=function(e){return t.location.hash=e,this},t.yamvc.Controller=e}(window),function(t){"use strict";function e(){for(var t=0,e=o.length;e>t;t++)o[t]()}var n,r,i=t.yamvc||{},o=[];i.onReady=function(t){o.push(t),r||"complete"===document.readyState||(r=setInterval(function(){"complete"===document.readyState&&(clearInterval(r),e())},10))},n=i.Core||function(){function t(){this.set("listeners",{}),this.set("suspendEvents",!1),this.bindMethods.apply(this,arguments),this.init.apply(this,arguments)}return t.prototype.init=function(){},t.prototype.initConfig=function(){var t,e,n,r=this,i=r.get("config"),o=function(n){t="get"+n.charAt(0).toUpperCase()+n.slice(1),e="set"+n.charAt(0).toUpperCase()+n.slice(1),r[t]=function(){return r.get("config")[n]},r[e]=function(t,e){var n=r.get("config")[t];e!==n&&(r.get("config")[t]=e,r.fireEvent(t+"Change",this,e,n))}};for(n in i)i.hasOwnProperty(n)&&o(n)},t.prototype.bindMethods=function(t){for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(this[e]=t[e].bind(this))},t.prototype.set=function(t,e){var n="_"+t,r=this[n];return e!==r&&(this[n]=e,this.fireEvent(t+"Change",this,e,r)),this},t.prototype.get=function(t){return this["_"+t]},t.prototype.init=function(){},t.prototype.fireEvent=function(t){if(this._listeners||(this._listeners=[]),this._suspendEvents)return!0;var e=!0,n=Array.prototype.shift;n.call(arguments);for(var r=0,i=this._listeners[t]||[],o=i.length;o>r;r++)if(e){var s=n.call(arguments);e=i[r].apply(s,arguments)}return e},t.prototype.addListener=function(t,e){this._listeners||(this._listeners=[]);var n=this._listeners[t]||[];return n.push(e),this._listeners[t]=n,this},t.prototype.removeListener=function(t,e){var n,r=this._listeners;if(r)if(e){if("function"==typeof e)for(var i=0,o=r.length;o>i;i++)r[i]===e&&(n=i);else n=e;r.splice(n,1)}else this._listeners=[];return this},t.prototype.suspendEvents=function(t){return t=t||!0,this.set("suspendEvents",t),this},t.prototype.onChange=function(t,e){return this.addListener(t+"Change",e),this},t.prototype.unbindOnChange=function(t,e){for(var n=this._listeners[t+"Change"]||[],r=0,i=n.length;i>r;r++)n[r]===e&&n.splice(r,1);return this._listeners[t+"Change"]=n,this},t.mixin=function(t,e){var n,r;e?n="function"==typeof t?t.prototype:t:(e="function"==typeof t?t.prototype:t,n=this.prototype);for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r])},t.extend=function(e){var n,r=this,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};return n=function(t){return o(e,t),e}(r),n.extend=t.extend,n.mixin=t.mixin,n},t}(),i.Core=n,t.yamvc=i}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,r=this;t=t||{},e=t.config||{},r.set("initOpts",t),r.set("config",e),r.initConfig()},e.prototype.initConfig=function(){var t=this;n.Core.prototype.initConfig.apply(this),t.set("lastResponse",{})},e.prototype.read=function(){},e.prototype.create=function(){},e.prototype.update=function(){},e.prototype.destroy=function(){},e.prototype.update=function(){},e.prototype.getResult=function(){var t=this;return t.get("lastResponse")},t.yamvc=n,t.yamvc.data=t.yamvc.data||{},t.yamvc.data.Proxy=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,r=this;t=t||{},e=t.config||{},r.set("initOpts",t),r.set("config",e),r.initConfig()},e.prototype.initConfig=function(){n.Core.prototype.initConfig.apply(this)},e.prototype.read=function(){var t,e=localStorage[model.getNamespace()]||{};for(t in e)e.hasOwnProperty(t)&&(model[t]=e[t])},e.prototype.create=function(){var t,e;localStorage[e.getNamespace()]={};for(t in e)e.hasOwnProperty(t)&&"function"!=typeof e[t]&&(localStorage[e.getNamespace()][t]=e[t])},e.prototype.update=function(){},e.prototype.destroy=function(){delete localStorage[model.getNamespace()]},e.prototype.update=function(){},t.yamvc=n,t.yamvc.data=t.yamvc.data||{},t.yamvc.data.proxy=t.yamvc.data.proxy||{},t.yamvc.data.proxy.Localstorage=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,r=this;t=t||{},e=t.config||{},r.set("initOpts",t),r.set("config",e),r.initConfig(),r.initData()},e.prototype.initConfig=function(){var t=this,e=t.get("config");if(n.Core.prototype.initConfig.apply(this),!e.namespace)throw Error("Model need to have namespace property in your model configuration");return this},e.prototype.initData=function(){var t=this,e=t.get("initOpts"),n=t.get("config");t.set("data",e.data||{}),t.set("idProperty",n.idProperty||"_id")},e.prototype.$set=function(t,e){var n=this,r=n.get("data"),i=r[t];e!==i&&(r[t]=e,n.set("isDirty",!0),n.fireEvent("property"+t.charAt(0).toUpperCase()+t.slice(1)+"Change",n,e,i))},e.prototype.$get=function(t){var e=this;return e.get("data")[t]},e.prototype.setData=function(t){var e,n=this,r=n.get("data");for(e in t)t.hasOwnProperty(e)&&n.$set(e,t[e]);n.fireEvent("dataChange",n,r)},e.prototype.load=function(t){var e,n,r=this,i=r.get("data"),o=r.get("idProperty"),s=0;for(n in t)s++;if(0===s&&i[o]===undefined)throw Error("You need to pass at least one condition to load model");0===s&&(t[o]=i[o]),e=function(){"success"===r.getProxy().getStatus()?(r.set("isDirty",!1),r.set("data",r.getProxy().getResponse()),r.fireEvent("loaded",r,r.getProxy().getResponse(),"read")):r.fireEvent("error",r,"read")},r.getProxy().read(r.getNamespace(),t,e)},e.prototype.save=function(){var t,e,n=this,r=n.get("data"),i=n.get("idProperty");return n.get("isProcessing")?!1:(n.set("isProcessing",!0),t=function(){n.set("isProcessing",!1),"success"===n.getProxy().getStatus()?(n.set("isDirty",!1),n.set("data",n.getProxy().getResponse()),n.fireEvent("saved",n,n.getProxy().getResponse(),e)):n.fireEvent("error",n,e)},r[i]===undefined?(e="create",n.getProxy().create(n.getNamespace(),r,t)):(e="update",n.getProxy().update(n.getNamespace(),r,t)),!0)},e.prototype.remove=function(){var t,e=this,n=e.get("data"),r=e.get("idProperty");if(n[r]===undefined)throw Error("Can not remove empty model");t=function(){"success"===e.getProxy().getStatus()?(delete n[r],e.set("isDirty",!1),e.set("data",{}),e.fireEvent("removed",e,"destroy")):e.fireEvent("error",e,"destroy")},e.getProxy().destroy(e.getNamespace(),n,t)},t.yamvc=n,t.yamvc.Model=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this)}),e.prototype.init=function(){this.set("routing",{}),this.bindEvents()},e.prototype.bindEvents=function(){return t.onhashchange=this.onHashChange.bind(this),this},e.prototype.onHashChange=function(){var e=this.get("routing"),n=t.location.hash.substr(1),r=n.split("/"),i=r.shift();if(e[i]){var o=[];if(e[i].params)for(var s=0,a=e[i].params.length;a>s;s++){var p=e[i].params[s],c=r[s],f=RegExp(p.substr(1,p.length-2));o.push(c.match(f).input)}e[i].callback.apply(null,o)}return this},e.prototype.restore=function(){return this.onHashChange(),this},e.prototype.when=function(t,e){var n=this.get("routing"),r=t.split("/"),i=r.shift();return n[i]={callback:e,params:r},this.set("routing",n),this},t.yamvc.Router=e}(window),function(t){"use strict";var e,n,r,i=t.yamvc||{};e={views:{},i:0,add:function(t,e){this.views[t]=e,this.i++},get:function(t){return this.views[t]}},n={tpl:{},add:function(t,e){this.tpl[t]=e},get:function(t){return this.tpl[t]}},r=i.Core.extend(function(){i.Core.apply(this,arguments)}),r.prototype.init=function(t){i.Core.prototype.init.apply(this);var n,r,o=this;t=t||{},n=t.config||{},n.id=r=n.id||"view-"+e.i,n.views=n.views||{},o.set("initOpts",t),o.set("config",n),o.initConfig(),e.add(r,o)},r.prototype.initConfig=function(){i.Core.prototype.initConfig.apply(this),this.initTemplate(),this.initModels()},r.prototype.initTemplate=function(){var t,e=this,r=e.get("config"),i=document.createElement("div");if(!r.tpl)throw Error("no tpl set");if(!n.get(r.tpl)){if(t=document.getElementById(r.tpl),!t)throw Error("no tpl "+r.tpl+" found");n.add(r.tpl,t.parentNode.removeChild(t))}i.innerHTML=n.get(r.tpl).innerHTML,e.set("tpl",i)},r.prototype.initModels=function(){var t,e,n=this;if(!n.getModels)return n;t=n.getModels();for(e in t)t.hasOwnProperty(e)&&n.setModel(e,t[e]);return n},r.prototype.setModel=function(t,e){var n=this,r=n.getModels();return r[e.getNamespace()]=e,n.setModels(r),n},r.prototype.getModel=function(t){var e=this,n=e.getModels();return n[t]},r.prototype.render=function(t){var e,n,r,i=this,o=i.get("tpl"),s=document.createElement("div"),a=i.get("config"),p=a.renderTo,c=t||a.models,f=a.parent,u=a.parent;if(f?f=p?f.querySelectorAll(p).item(0):f.get("el"):p&&(f=document.querySelectorAll(p).item(0)),c){if(r=o.innerHTML,n=r.match(/\{\{(.*?)\}\}/gi))for(var d=0,y=n.length;y>d;d++){var l=n[d],g=l.substr(2,l.length-4).split(".");r=c[g[0]]!==undefined&&"function"!=typeof c[g[0]]?r.replace(l,c[g[0]].$get(g[1])):r.replace(l,"")}s.innerHTML=r}for(var h=0;o.childNodes.length>h&&1!==o.childNodes.item(h).nodeType;)h++;return e=s.childNodes.item(h),e.setAttribute("yamvc-id",a.id),i.set("el",e),f&&(f.appendChild(e),u&&(u.views=u.views||{},u.views[a.id]=i),i.set("isInDOM",!0),i.reAppendChildren(),i.fireEvent("render",null,i)),e},r.prototype.partialRender=function(t){var e,n=this,r=n.get("tpl"),i=r.querySelector(t),o=n.queryEl(t),s=i.innerHTML,a=n.getModels();if(e=s.match(/\{\{(.*?)\}\}/gi))for(var p=0,c=e.length;c>p;p++){var f=e[p],u=f.substr(2,f.length-4).split(".");s=a[u[0]]!==undefined&&"function"!=typeof a[u[0]]?s.replace(f,a[u[0]].$get(u[1])):s.replace(f,"")}return o.innerHTML=s,n.fireEvent("partialRender",null,n,o),n},r.prototype.queryEl=function(t){return this.get("el").querySelector(t)},r.prototype.addChild=function(t,e){var n=this;return t.appendTo(n,e),n.fireEvent("elementAdded",n,t),n},r.prototype.removeChildren=function(){for(var t=this.get("config").views||[],e=0,n=t.length;n>e;e++)t[e].clear()},r.prototype.clear=function(){var t=this,e=t.get("el");return t.isInDOM()&&(e.parentNode.removeChild(e),t.set("isInDOM",!1)),t},r.prototype.isInDOM=function(){return this._isInDOM},r.prototype.appendTo=function(t,e){var n=this,r=n.get("config"),i=r.id,o=t.get("config").views,s=e?t.get("el").querySelector(e):t.get("el");return e&&(r.renderTo=e),r.parent&&r.parent.get("config").id!==t.get("config").id&&delete r.parent.get("config").views[i],!n.isInDOM()&&t.isInDOM()&&(n.get("el")?(s.appendChild(n.get("el")),n.set("isInDOM",!0),n.reAppendChildren(),n.fireEvent("render",null,n)):n.render()),o[i]=n,r.parent=t,n},r.prototype.reAppendChildren=function(){var t=this.get("config").views;for(var e in t)t.hasOwnProperty(e)&&t[e].appendTo(this)},i.ViewManager=e,t.yamvc=i,t.yamvc.View=r}(window);
//@ sourceMappingURL=YAMVC-v0.1.2.min.js.map